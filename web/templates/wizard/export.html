{% extends "layouts/base.html" %}

{% block title %}Export | Open OSCAL Wizard{% endblock %}

{% block content %}
  <h1 class="usa-heading">Export</h1>
  <p class="usa-intro">
    Export deterministic OSCAL SSP JSON from a workspace file.
  </p>

  {% if errors %}
    <div class="usa-alert usa-alert--error" role="alert" tabindex="-1" id="error-summary">
      <div class="usa-alert__body">
        <h2 class="usa-alert__heading">Please fix the errors below</h2>
        <ul class="usa-list">
          {% for error in errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% endif %}

  <form class="usa-form" method="post" action="/export/ssp" enctype="multipart/form-data" novalidate>
    <label class="usa-label" for="workspace-file">Workspace JSON</label>
    <div class="usa-hint" id="workspace-hint">Upload a workspace JSON file.</div>
    <input
      class="usa-file-input"
      id="workspace-file"
      name="workspace_file"
      type="file"
      accept=".json,application/json"
      aria-describedby="workspace-hint"
      required
    >
    <button class="usa-button margin-top-3" type="submit">Export SSP JSON</button>
  </form>

  {% if export_ready %}
    <div class="usa-alert usa-alert--success margin-top-3" role="status">
      <div class="usa-alert__body">
        <p class="usa-alert__text">
          SSP export is ready. Download the file below.
        </p>
      </div>
    </div>
    <a class="usa-button margin-top-2" href="/export/download">Download SSP JSON</a>
  {% endif %}

  <div class="usa-alert usa-alert--info margin-top-3" role="status">
    <div class="usa-alert__body">
      <p class="usa-alert__text">
        Output is deterministic and aligned to OSCAL v1.2.0.
      </p>
    </div>
  </div>
{% endblock %}
