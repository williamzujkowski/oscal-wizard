{% extends "layouts/base.html" %}

{% block title %}Components | Open OSCAL Wizard{% endblock %}

{% block content %}
  <h1 class="usa-heading">Components</h1>
  <p class="usa-intro">
    Define the components that make up your system inventory.
  </p>

  {% if errors %}
    <div class="usa-alert usa-alert--error" role="alert" tabindex="-1" id="error-summary">
      <div class="usa-alert__body">
        <h2 class="usa-alert__heading">Please fix the errors below</h2>
        <ul class="usa-list">
          {% for error in errors %}
            <li>{{ error.field }}: {{ error.msg }}</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% endif %}

  <form class="usa-form" method="post" action="/inventory" novalidate>
    <fieldset class="usa-fieldset">
      <legend class="usa-legend">Add a component</legend>
      <label class="usa-label" for="component-type">Component type</label>
      <input
        class="usa-input"
        id="component-type"
        name="component_type"
        type="text"
        value="{{ form_data.get('component_type', '') }}"
        required
      >

      <label class="usa-label" for="component-title">Title</label>
      <input
        class="usa-input"
        id="component-title"
        name="title"
        type="text"
        value="{{ form_data.get('title', '') }}"
        required
      >

      <label class="usa-label" for="component-description">Description</label>
      <textarea
        class="usa-textarea"
        id="component-description"
        name="description"
        required
      >{{ form_data.get('description', '') }}</textarea>

      <button class="usa-button margin-top-2" type="submit" name="action" value="add">
        Add component
      </button>
    </fieldset>

    <fieldset class="usa-fieldset margin-top-4">
      <legend class="usa-legend">Import component definitions</legend>
      <div class="usa-hint">
        Provide a directory path containing OSCAL component-definition JSON files.
      </div>
      <label class="usa-label" for="component-library-dir">Component library directory</label>
      <input
        class="usa-input"
        id="component-library-dir"
        name="component_library_dir"
        type="text"
        value="{{ form_data.get('component_library_dir', '') }}"
      >
      <button
        class="usa-button usa-button--outline margin-top-2"
        type="submit"
        name="action"
        value="import"
        formnovalidate
      >
        Import components
      </button>
    </fieldset>
  </form>

  {% if components %}
    <div class="margin-top-4">
      <h2 class="usa-heading--sm">Added components</h2>
      <ul class="usa-list">
        {% for component in components %}
          <li>
            <strong>{{ component.title }}</strong> ({{ component.component_type }})
            <div class="usa-hint">{{ component.description }}</div>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {% if imported_components %}
    <div class="margin-top-4">
      <h2 class="usa-heading--sm">Imported components</h2>
      <ul class="usa-list">
        {% for component in imported_components %}
          <li>
            <strong>{{ component.title }}</strong> ({{ component.component_type }})
            <div class="usa-hint">{{ component.description }}</div>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
{% endblock %}
